{% doc %}
  Renders a responsive image that might be wrapped in a link.

  @param {image} image - The image to be rendered
  @param {string} [url] - Optional destination URL
  @param {string} [css_class] - Optional class for the image/wrapper
  @param {string} [alt] - Optional alt text (falls back to image.alt)
{% enddoc %}

{% liquid
  if url
    assign wrapper = 'a'
  else
    assign wrapper = 'div'
  endif
%}

<{{ wrapper }} class="image {{ css_class }}" {% if url %}href="{{ url }}"{% endif %}>
  <img
    src="{{ image | image_url: width: width, height: height, crop: crop }}"
    alt="{{ alt | default: image.alt | escape }}"
    class="{{ css_class }}"
    loading="lazy"
    decoding="async"
  />
</{{ wrapper }}>

{% stylesheet %}
  .image { display:block; overflow:hidden; width:100%; }
  .image > img { width:100%; height:auto; display:block; }
{% endstylesheet %}
